tasks:
  prebuild:
    linux:
      steps:
        - echo "Prebuild (linux)"
        - echo $TEST
        - print_dir
        - echo $TEST
      config:
        execution_policy: fast_fail
    macos:
      steps:
        - 'echo "Prebuild (macos)"'
        - 'echo $TEST'
    windows:
      steps:
        - 'echo Prebuild (windows)'
        - 'echo %TEST%'
        - set TEST=script
      config:
        execution_policy: carry_forward
        env:
          TEST: "local"

  build:
    linux:
      steps:
        - echo $TEST
    windows:
      steps:
        - echo %TEST%
    macos:
      steps:
        - echo $TEST

  clean:
    linux:
      steps:
        - 'echo "Clean (linux)"'
        - 'echo $TEST'
    macos:
      steps:
        - 'echo "Clean (macos)"'
    windows:
      steps:
        - 'echo Clean (windows)'

blocks:
  print_dir:
    steps:
      - echo 'Printing CWD'
      - asds
      - ls -la
    config:
      execution_policy: fast_fail

config:
  execution_policy: fast_fail
  env:
    TEST: "09123"
  skip_sections:
    - clean
  